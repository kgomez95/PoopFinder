/*!
 * PoopFinder v1.0
 *
 * Autor: Kevin G칩mez Codina
 * Date: 2021-12-15T12:37Z
 */
"use strict";var PoopFinderGame=function(d){var l={easy:"easy",normal:"normal",hard:"hard"},u={poop:-1,flag:-2,questionMark:-3,genetaId:function(e,t){return"x"+e+"y"+t}},a={timeout:500},t={interval:100,increase:.1},o=(e.prototype.toggleMainMenu=function(e){this.mainMenu.style.display=e?"block":"none"},e.prototype.toggleGameMenu=function(e){this.gameMenu.style.display=e?"flex":"none"},e.prototype.togglePauseMenu=function(e){e?(this.pauseMenu.style.display="block",this.game.isGamePaused=!0):(this.pauseMenu.style.display="none",this.game.isGamePaused=!1)},e.prototype.toggleBoard=function(e){this.boardContainer.style.display=e?"block":"none"},e.prototype.createBoard=function(e,t){var o=this,a=d.document.createElement("div"),n=d.document.createElement("table");a.className="poop-table-container",n.className="poop-table",o.board={};for(var i=0;i<e;i++){for(var r=d.document.createElement("tr"),s=0;s<t;s++){var c=d.document.createElement("td");c.setAttribute("value",""),c.setAttribute("selected","0"),void 0!==c.ontouchstart?(c.ontouchstart=function(e,t){return function(){o.game.board.startTouch(e,t)}}(i,s),c.ontouchend=function(e,t){return function(){o.game.board.endTouch(e,t)}}(i,s),c.ontouchmove=function(){o.game.board.cancelTouch()}):(c.onclick=function(e,t){return function(){o.game.board.checkOff(e,t)}}(i,s),c.oncontextmenu=function(e,t){return function(){o.game.board.setFlag(e,t)}}(i,s)),o.board[u.genetaId(i,s)]=c,r.appendChild(c)}n.appendChild(r)}n.oncontextmenu=function(e){e.preventDefault()},o.boardContainer&&o.container.removeChild(o.boardContainer),a.appendChild(n),o.boardContainer=a,o.container.appendChild(o.boardContainer)},e.prototype.updateCountPoops=function(e){this.poopCounter.innerHTML="number"==typeof e?e.toString():""},e.prototype.updateTimer=function(e){this.timer.innerHTML="number"==typeof e?e.toString():""},e.prototype.setDefaultFace=function(){this.pauseButton.className="menu face"},e.prototype.setVictoryFace=function(){this.pauseButton.className="menu kiss"},e.prototype.setDefeatFace=function(){this.pauseButton.className="menu confounded"},e);function e(e,t){var o,a,n,i,r,s,c,u=this;u.container=void 0,u.mainMenu=void 0,u.gameMenu=void 0,u.pauseMenu=void 0,u.boardContainer=void 0,u.poopCounter=void 0,u.timer=void 0,u.pauseButton=void 0,u.game=t,u.board={},function(){if(u.container=d.document.getElementById(e),!u.container)throw new Error("PoopFinder: No se ha podido localizar el contenedor DOM con identificador '"+e+"'.");u.container.className="poop-finder"}(),s=d.document.createElement("div"),r=d.document.createElement("h1"),i=d.document.createElement("ul"),a=d.document.createElement("li"),n=d.document.createElement("li"),o=d.document.createElement("li"),r.appendChild(d.document.createTextNode("游눨Poop~Finder游눨")),a.appendChild(d.document.createTextNode("F치cil")),n.appendChild(d.document.createTextNode("Normal")),o.appendChild(d.document.createTextNode("Dif칤cil")),a.onclick=function(){u.game.newGame(l.easy)},n.onclick=function(){u.game.newGame(l.normal)},o.onclick=function(){u.game.newGame(l.hard)},i.appendChild(a),i.appendChild(n),i.appendChild(o),s.className="main-menu",s.appendChild(r),s.appendChild(i),u.mainMenu=s,u.container.appendChild(u.mainMenu),c=d.document.createElement("div"),t=d.document.createElement("div"),a=d.document.createElement("div"),n=d.document.createElement("div"),o=d.document.createElement("span"),r=d.document.createElement("span"),i=d.document.createElement("span"),s=d.document.createElement("span"),c.className="game-menu",o.className="flag",i.className="menu face",i.onclick=function(){u.togglePauseMenu(!0)},t.appendChild(o),t.appendChild(r),a.appendChild(i),n.appendChild(s),c.appendChild(t),c.appendChild(a),c.appendChild(n),u.poopCounter=r,u.timer=s,u.pauseButton=i,r.innerHTML="0",s.innerHTML="0",u.gameMenu=c,u.container.appendChild(u.gameMenu),u.toggleGameMenu(!1),t=d.document.createElement("div"),a=d.document.createElement("div"),n=d.document.createElement("h2"),i=d.document.createElement("ul"),r=d.document.createElement("li"),s=d.document.createElement("li"),c=d.document.createElement("li"),n.innerHTML="JUEGO PAUSADO",r.innerHTML="Continuar",s.innerHTML="Reiniciar",c.innerHTML="Elegir dificultad",t.className="pause-menu",r.onclick=function(){u.togglePauseMenu(!1)},s.onclick=function(){u.game.stopTimer(),u.game.newGame(u.game.difficulty),u.togglePauseMenu(!1)},c.onclick=function(){u.toggleGameMenu(!1),u.togglePauseMenu(!1),u.toggleBoard(!1),u.game.stopTimer(),u.toggleMainMenu(!0)},i.appendChild(r),i.appendChild(s),i.appendChild(c),a.appendChild(n),a.appendChild(i),t.appendChild(a),u.pauseMenu=t,u.container.appendChild(u.pauseMenu),u.togglePauseMenu(!1)}var n=(i.prototype.checkOff=function(e,t){this.game.isGameOver||(this.game.startTimer(),this.markCell(e,t,!1),this.cellsToWin<=0&&this.game.gameOver(!0))},i.prototype.markCell=function(e,t,o){if(void 0!==this.board[e]&&void 0!==this.board[e][t]){var a=this.game.interface.board[u.genetaId(e,t)];if(!a)throw new Error("PoopFinder: No se ha encontrado el elemento x = '"+e+"' e y = '"+t+"'.");var n=d.parseInt(a.getAttribute("value"));if(0===d.parseInt(a.getAttribute("selected"))&&(d.isNaN(n)||o))if(this.board[e][t]===u.poop)this.game.gameOver(!1);else if(d.isNaN(n)||(n===u.flag?(a.className="",this.totalPoops++,this.game.interface.updateCountPoops(this.totalPoops)):n===u.questionMark&&(a.className="")),a.setAttribute("value",this.board[e][t]),a.className="selected cell-"+this.board[e][t],a.setAttribute("selected","1"),this.cellsToWin--,0===this.board[e][t])for(var i=e-1;i<=e+1;i++)for(var r=t-1;r<=t+1;r++)void 0!==this.board[i]&&void 0!==this.board[i][r]&&this.markCell(i,r,!0);else for(i=e-1;i<=e+1;i++)for(r=t-1;r<=t+1;r++)void 0!==this.board[i]&&0===this.board[i][r]&&this.markCell(i,r,!0)}},i.prototype.showPoops=function(){for(var e=0;e<this.x;e++)for(var t=0;t<this.y;t++)this.board[e][t]===u.poop&&(this.game.interface.board[u.genetaId(e,t)].className="explosion mine")},i.prototype.showFlags=function(){for(var e=0;e<this.x;e++)for(var t,o=0;o<this.y;o++)this.board[e][o]!==u.poop||-1===(t=this.game.interface.board[u.genetaId(e,o)]).className.indexOf("flag")&&(t.className="flag",this.totalPoops--);this.game.interface.updateCountPoops(this.totalPoops)},i.prototype.setFlag=function(e,t){this.game.isGameOver||(this.game.startTimer(),e=this.game.interface.board[u.genetaId(e,t)],t=d.parseInt(e.getAttribute("value")),d.isNaN(t)?(e.setAttribute("value",u.flag),e.className="flag",this.totalPoops--,this.game.interface.updateCountPoops(this.totalPoops)):t===u.flag?(e.setAttribute("value",u.questionMark),e.className="question-flag",this.totalPoops++,this.game.interface.updateCountPoops(this.totalPoops)):t===u.questionMark&&(e.setAttribute("value",""),e.className=""))},i.prototype.startTouch=function(e,t){var o=this;o.touch.type=0,o.touch.element=o.game.interface.board[u.genetaId(e,t)],o.touch.timeout=d.setTimeout(function(){o.touch.type=1},a.timeout)},i.prototype.endTouch=function(e,t){d.clearTimeout(this.touch.timeout),(this.touch.timeout=0)===this.touch.type?this.checkOff(e,t):1===this.touch.type&&this.setFlag(e,t)},i.prototype.cancelTouch=function(){clearTimeout(this.touch.timeout),this.touch.timeout=0,this.touch.type=-1},i);function i(e,t,o,a){var i=this;i.x=e,i.y=t,i.poops=o,i.board=[],i.game=a,i.totalPoops=o,i.touch={type:-1,element:void 0,timeout:0},i.cellsToWin=i.x*i.y-i.poops,function(){{if(!i.x||!i.y)throw new Error("PoopFinder: Es necesario especificar una anchura y una altura para inicializar el tablero de juego.");if(!d.parseInt(i.x.toString())||i.x<=0||!d.parseInt(i.y.toString())||i.y<=0)throw new Error("PoopFinder: Es necesario especificar una anchura y una altura correcta para el tablero de juego.")}if(!i.poops||!d.parseInt(i.poops.toString())||i.poops<=0)throw new Error('PoopFinder: Es necesario especificar al menos una "mina" en el tablero de juego.');if(i.x*i.y<=i.poops)throw new Error('PoopFinder: Tiene que haber al menos una posici칩n libre de "minas" en el tablero de juego.')}(),function(){i.board=new Array(i.x);for(var e=0;e<i.x;e++){i.board[e]=new Array(i.y);for(var t=0;t<i.y;t++)i.board[e][t]=0}var o=i.poops;for(;0<o;){e=Math.floor(Math.random()*i.x),t=Math.floor(Math.random()*i.y);i.board[e][t]!==u.poop&&(i.board[e][t]=u.poop,o--)}for(e=0;e<i.x;e++)for(t=0;t<i.y;t++)0===i.board[e][t]&&(i.board[e][t]=function(e,t){for(var o=0,a=e-1;a<=e+1;a++)for(var n=t-1;n<=t+1;n++)void 0!==i.board[a]&&i.board[a][n]===u.poop&&o++;return o}(e,t))}(),i.game.interface.createBoard(i.x,i.y),i.game.interface.toggleMainMenu(!1),i.game.interface.toggleGameMenu(!0),i.game.interface.updateCountPoops(i.totalPoops),i.game.interface.setDefaultFace()}function r(e){this.interface=new o(e,this),this.board=void 0,this.isGameOver=!1,this.isGamePaused=!1,this.difficulty="",this.timer=0,this.timerInterval=0}return r.prototype.newGame=function(e){switch(this.difficulty=e,this.isGameOver=!1,this.isGamePaused=!1,this.timer=0,this.interface.updateTimer(this.timer),e){case l.easy:this.board=new n(9,9,10,this);break;case l.normal:this.board=new n(16,16,40,this);break;case l.hard:this.board=new n(16,30,99,this);break;default:throw this.difficulty="",new Error("PoopFinder: La dificultad '"+e+"' no es v치lida.")}},r.prototype.gameOver=function(e){this.isGameOver=!0,this.stopTimer(),e?(this.interface.setVictoryFace(),this.board.showFlags()):(this.interface.setDefeatFace(),this.board.showPoops())},r.prototype.startTimer=function(){var e=this;0===e.timerInterval&&(e.timer=0,e.timerInterval=d.setInterval(function(){e.isGamePaused||(e.timer=d.Math.round(10*(e.timer+t.increase))/10,e.timer%1==0&&e.interface.updateTimer(e.timer))},t.interval))},r.prototype.stopTimer=function(){0!==this.timerInterval&&(d.clearInterval(this.timerInterval),this.timerInterval=0)},r}(window),PoopFinderGame=function(d){var l="easy",p="normal",m="hard",s=-1,c=-2,u=-3,h=function(e,t){return"x"+e+"y"+t},a=500,t=100,o=.1,n=(e.prototype.toggleMainMenu=function(e){this.mainMenu.style.display=e?"block":"none"},e.prototype.toggleGameMenu=function(e){this.gameMenu.style.display=e?"flex":"none"},e.prototype.togglePauseMenu=function(e){e?(this.pauseMenu.style.display="block",this.game.isGamePaused=!0):(this.pauseMenu.style.display="none",this.game.isGamePaused=!1)},e.prototype.toggleBoard=function(e){this.boardContainer.style.display=e?"block":"none"},e.prototype.createBoard=function(e,t){var o=this,a=d.document.createElement("div"),n=d.document.createElement("table");a.className="poop-table-container",n.className="poop-table",o.board={};for(var i=0;i<e;i++){for(var r=d.document.createElement("tr"),s=0;s<t;s++){var c=d.document.createElement("td");c.setAttribute("value",""),c.setAttribute("selected","0"),void 0!==c.ontouchstart?(c.ontouchstart=function(e,t){return function(){o.game.board.startTouch(e,t)}}(i,s),c.ontouchend=function(e,t){return function(){o.game.board.endTouch(e,t)}}(i,s),c.ontouchmove=function(){o.game.board.cancelTouch()}):(c.onclick=function(e,t){return function(){o.game.board.checkOff(e,t)}}(i,s),c.oncontextmenu=function(e,t){return function(){o.game.board.setFlag(e,t)}}(i,s)),o.board[h(i,s)]=c,r.appendChild(c)}n.appendChild(r)}n.oncontextmenu=function(e){e.preventDefault()},o.boardContainer&&o.container.removeChild(o.boardContainer),a.appendChild(n),o.boardContainer=a,o.container.appendChild(o.boardContainer)},e.prototype.updateCountPoops=function(e){this.poopCounter.innerHTML="number"==typeof e?e.toString():""},e.prototype.updateTimer=function(e){this.timer.innerHTML="number"==typeof e?e.toString():""},e.prototype.setDefaultFace=function(){this.pauseButton.className="menu face"},e.prototype.setVictoryFace=function(){this.pauseButton.className="menu kiss"},e.prototype.setDefeatFace=function(){this.pauseButton.className="menu confounded"},e);function e(e,t){var o,a,n,i,r,s,c,u=this;u.container=void 0,u.mainMenu=void 0,u.gameMenu=void 0,u.pauseMenu=void 0,u.boardContainer=void 0,u.poopCounter=void 0,u.timer=void 0,u.pauseButton=void 0,u.game=t,u.board={},function(){if(u.container=d.document.getElementById(e),!u.container)throw new Error("PoopFinder: No se ha podido localizar el contenedor DOM con identificador '"+e+"'.");u.container.className="poop-finder"}(),s=d.document.createElement("div"),r=d.document.createElement("h1"),i=d.document.createElement("ul"),a=d.document.createElement("li"),n=d.document.createElement("li"),o=d.document.createElement("li"),r.appendChild(d.document.createTextNode("游눨Poop~Finder游눨")),a.appendChild(d.document.createTextNode("F치cil")),n.appendChild(d.document.createTextNode("Normal")),o.appendChild(d.document.createTextNode("Dif칤cil")),a.onclick=function(){u.game.newGame(l)},n.onclick=function(){u.game.newGame(p)},o.onclick=function(){u.game.newGame(m)},i.appendChild(a),i.appendChild(n),i.appendChild(o),s.className="main-menu",s.appendChild(r),s.appendChild(i),u.mainMenu=s,u.container.appendChild(u.mainMenu),c=d.document.createElement("div"),t=d.document.createElement("div"),a=d.document.createElement("div"),n=d.document.createElement("div"),o=d.document.createElement("span"),r=d.document.createElement("span"),i=d.document.createElement("span"),s=d.document.createElement("span"),c.className="game-menu",o.className="flag",i.className="menu face",i.onclick=function(){u.togglePauseMenu(!0)},t.appendChild(o),t.appendChild(r),a.appendChild(i),n.appendChild(s),c.appendChild(t),c.appendChild(a),c.appendChild(n),u.poopCounter=r,u.timer=s,u.pauseButton=i,r.innerHTML="0",s.innerHTML="0",u.gameMenu=c,u.container.appendChild(u.gameMenu),u.toggleGameMenu(!1),t=d.document.createElement("div"),a=d.document.createElement("div"),n=d.document.createElement("h2"),i=d.document.createElement("ul"),r=d.document.createElement("li"),s=d.document.createElement("li"),c=d.document.createElement("li"),n.innerHTML="JUEGO PAUSADO",r.innerHTML="Continuar",s.innerHTML="Reiniciar",c.innerHTML="Elegir dificultad",t.className="pause-menu",r.onclick=function(){u.togglePauseMenu(!1)},s.onclick=function(){u.game.stopTimer(),u.game.newGame(u.game.difficulty),u.togglePauseMenu(!1)},c.onclick=function(){u.toggleGameMenu(!1),u.togglePauseMenu(!1),u.toggleBoard(!1),u.game.stopTimer(),u.toggleMainMenu(!0)},i.appendChild(r),i.appendChild(s),i.appendChild(c),a.appendChild(n),a.appendChild(i),t.appendChild(a),u.pauseMenu=t,u.container.appendChild(u.pauseMenu),u.togglePauseMenu(!1)}var i=(r.prototype.checkOff=function(e,t){this.game.isGameOver||(this.game.startTimer(),this.markCell(e,t,!1),this.cellsToWin<=0&&this.game.gameOver(!0))},r.prototype.markCell=function(e,t,o){if(void 0!==this.board[e]&&void 0!==this.board[e][t]){var a=this.game.interface.board[h(e,t)];if(!a)throw new Error("PoopFinder: No se ha encontrado el elemento x = '"+e+"' e y = '"+t+"'.");var n=d.parseInt(a.getAttribute("value"));if(0===d.parseInt(a.getAttribute("selected"))&&(d.isNaN(n)||o))if(this.board[e][t]===s)this.game.gameOver(!1);else if(d.isNaN(n)||(n===c?(a.className="",this.totalPoops++,this.game.interface.updateCountPoops(this.totalPoops)):n===u&&(a.className="")),a.setAttribute("value",this.board[e][t]),a.className="selected cell-"+this.board[e][t],a.setAttribute("selected","1"),this.cellsToWin--,0===this.board[e][t])for(var i=e-1;i<=e+1;i++)for(var r=t-1;r<=t+1;r++)void 0!==this.board[i]&&void 0!==this.board[i][r]&&this.markCell(i,r,!0);else for(i=e-1;i<=e+1;i++)for(r=t-1;r<=t+1;r++)void 0!==this.board[i]&&0===this.board[i][r]&&this.markCell(i,r,!0)}},r.prototype.showPoops=function(){for(var e=0;e<this.x;e++)for(var t=0;t<this.y;t++)this.board[e][t]===s&&(this.game.interface.board[h(e,t)].className="explosion mine")},r.prototype.showFlags=function(){for(var e=0;e<this.x;e++)for(var t,o=0;o<this.y;o++)this.board[e][o]!==s||-1===(t=this.game.interface.board[h(e,o)]).className.indexOf("flag")&&(t.className="flag",this.totalPoops--);this.game.interface.updateCountPoops(this.totalPoops)},r.prototype.setFlag=function(e,t){this.game.isGameOver||(this.game.startTimer(),e=this.game.interface.board[h(e,t)],t=d.parseInt(e.getAttribute("value")),d.isNaN(t)?(e.setAttribute("value",c),e.className="flag",this.totalPoops--,this.game.interface.updateCountPoops(this.totalPoops)):t===c?(e.setAttribute("value",u),e.className="question-flag",this.totalPoops++,this.game.interface.updateCountPoops(this.totalPoops)):t===u&&(e.setAttribute("value",""),e.className=""))},r.prototype.startTouch=function(e,t){var o=this;o.touch.type=0,o.touch.element=o.game.interface.board[h(e,t)],o.touch.timeout=d.setTimeout(function(){o.touch.type=1},a)},r.prototype.endTouch=function(e,t){d.clearTimeout(this.touch.timeout),(this.touch.timeout=0)===this.touch.type?this.checkOff(e,t):1===this.touch.type&&this.setFlag(e,t)},r.prototype.cancelTouch=function(){clearTimeout(this.touch.timeout),this.touch.timeout=0,this.touch.type=-1},r);function r(e,t,o,a){var i=this;i.x=e,i.y=t,i.poops=o,i.board=[],i.game=a,i.totalPoops=o,i.touch={type:-1,element:void 0,timeout:0},i.cellsToWin=i.x*i.y-i.poops,function(){if(!i.x||!i.y)throw new Error("PoopFinder: Es necesario especificar una anchura y una altura para inicializar el tablero de juego.");if(!d.parseInt(i.x.toString())||i.x<=0||!d.parseInt(i.y.toString())||i.y<=0)throw new Error("PoopFinder: Es necesario especificar una anchura y una altura correcta para el tablero de juego.");if(!i.poops||!d.parseInt(i.poops.toString())||i.poops<=0)throw new Error('PoopFinder: Es necesario especificar al menos una "mina" en el tablero de juego.');if(i.x*i.y<=i.poops)throw new Error('PoopFinder: Tiene que haber al menos una posici칩n libre de "minas" en el tablero de juego.')}(),function(){i.board=new Array(i.x);for(var e=0;e<i.x;e++){i.board[e]=new Array(i.y);for(var t=0;t<i.y;t++)i.board[e][t]=0}for(var o=i.poops;0<o;)e=Math.floor(Math.random()*i.x),t=Math.floor(Math.random()*i.y),i.board[e][t]!==s&&(i.board[e][t]=s,o--);for(e=0;e<i.x;e++)for(t=0;t<i.y;t++)0===i.board[e][t]&&(i.board[e][t]=function(e,t){for(var o=0,a=e-1;a<=e+1;a++)for(var n=t-1;n<=t+1;n++)void 0!==i.board[a]&&i.board[a][n]===s&&o++;return o}(e,t))}(),i.game.interface.createBoard(i.x,i.y),i.game.interface.toggleMainMenu(!1),i.game.interface.toggleGameMenu(!0),i.game.interface.updateCountPoops(i.totalPoops),i.game.interface.setDefaultFace()}function f(e){this.interface=new n(e,this),this.board=void 0,this.isGameOver=!1,this.isGamePaused=!1,this.difficulty="",this.timer=0,this.timerInterval=0}return f.prototype.newGame=function(e){switch(this.difficulty=e,this.isGameOver=!1,this.isGamePaused=!1,this.timer=0,this.interface.updateTimer(this.timer),e){case l:this.board=new i(9,9,10,this);break;case p:this.board=new i(16,16,40,this);break;case m:this.board=new i(16,30,99,this);break;default:throw this.difficulty="",new Error("PoopFinder: La dificultad '"+e+"' no es v치lida.")}},f.prototype.gameOver=function(e){this.isGameOver=!0,this.stopTimer(),e?(this.interface.setVictoryFace(),this.board.showFlags()):(this.interface.setDefeatFace(),this.board.showPoops())},f.prototype.startTimer=function(){var e=this;0===e.timerInterval&&(e.timer=0,e.timerInterval=d.setInterval(function(){e.isGamePaused||(e.timer=d.Math.round(10*(e.timer+o))/10,e.timer%1==0&&e.interface.updateTimer(e.timer))},t))},f.prototype.stopTimer=function(){0!==this.timerInterval&&(d.clearInterval(this.timerInterval),this.timerInterval=0)},f}(window);